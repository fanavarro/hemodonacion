#colnames(found) = colnames(database)
found = read.table(text="", col.names = colnames(database))
# Si el xlsx tiene entrada para dbsnp e id de refseq
if("dbsnp" %in% colnames(xls) && "transcript" %in% colnames(xls)){
for (i in 1:nrow(xls)){
dbsnp = toString(xls[i, "dbsnp"])
refseq_id = toString(xls[i,"transcript"])
entry = database[database$TRANSCRIPT_REFSEQ_ID == refseq_id & !is.na(database$TRANSCRIPT_REFSEQ_ID) & database$VARIATION_NAME == dbsnp & !is.na(database$VARIATION_NAME), ]
if (!is.na(entry) && nrow(entry) != 0){
found = rbind(found, entry)
}
}
}
return(found)
}
filter_xls = function(xls){
minCoverage = 20
minQuality = 60
# Filter the position affected by the mutation
if("proteinPos" %in% colnames(xls)){
xls = xls[xls$proteinPos == 1,]
} else if ("protein" %in% colnames(xls)){
index = with(xls, grepl("p.Met1[a-zA-Z]", protein))
xls = xls[index,]
}
# Filter by coverage and quality
if ("coverage" %in% colnames(xls)){
xls = xls[xls$coverage >= minCoverage,]
}
return(xls)
}
filter_xls = function(xls){
minCoverage = 20
# Filter the position affected by the mutation
if("proteinPos" %in% colnames(xls)){
xls = xls[xls$proteinPos == 1,]
} else if ("protein" %in% colnames(xls)){
index = with(xls, grepl("p.Met1[a-zA-Z]", protein))
xls = xls[index,]
}
# Filter by coverage and quality
if ("coverage" %in% colnames(xls)){
xls = xls[xls$coverage >= minCoverage,]
}
return(xls)
}
get_gene_names = function(xls){
if("gene" %in% colnames(xls)){
return(sort(xls$gene))
}
}
get_dbsnp_ids = function(xls){
if("dbsnp" %in% colnames(xls)){
return(sort(xls[!is.na(xls$dbsnp), "dbsnp"]))
}
}
exome_files = c("14-173.xlsx",
"2064.xlsx",
"ABGP.xlsx",
"Exoma 2166 nuevo.xlsx",
"Paqui.xlsx")
exome_tables = hash()
# Read xlsx files and store it in a hash
for (file in exome_files){
abs_file_dir = paste(exomes_dir, file, sep="")
exome_tables[file] = read.xls(abs_file_dir)
write(paste("exoma", file, "leido."), "")
}
nrow(exome_tables[["14-173.xlsx"]])
nrow(exome_tables[["2064.xlsx"]])
nrow(exome_tables[["ABGP.xlsx"]])
nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]])
nrow(exome_tables[["Paqui.xlsx"]])
for (file in exome_files){
exome_tables[file] = filter_xls(exome_tables[[file]])
}
nrow(exome_tables[["14-173.xlsx"]])
nrow(exome_tables[["2064.xlsx"]])
nrow(exome_tables[["ABGP.xlsx"]])
nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]])
nrow(exome_tables[["Paqui.xlsx"]])
# get genes
genes = c()
for (file in exome_files){
genes = c(genes, as.vector(get_gene_names(exome_tables[[file]])))
}
genes = c()
for (file in exome_files){
genes = c(genes, as.vector(get_gene_names(exome_tables[[file]])))
}
# get dbsnp ids
dbsnp_ids = c()
for (file in exome_files){
dbsnp_ids = c(dbsnp_ids, as.vector(get_dbsnp_ids(exome_tables[[file]])))
}
length(genes)
14+12+6+8+20
length(dbsnp_ids)
length(unique(dbsnp_ids))
length(unique(genes))
dbsnp_ids
View(exome_tables[["14-173.xlsx"]])
View(exome_tables[["2064.xlsx"]])
View(exome_tables[["ABGP.xlsx"]])
View(exome_tables[["Exoma 2166 nuevo.xlsx"]])
View(exome_tables[["Paqui.xlsx"]])
length(unique(genes))
View(exome_tables[["14-173.xlsx"]])
get_gene_names(exome_tables[["14-173.xlsx"]])
View(search(csv, exome_tables[["14-173.xlsx"]]))
View(exome_tables[["2064.xlsx"]])
View(search(csv, exome_tables[["2064.xlsx"]]))
View(search(csv, exome_tables[["ABGP.xlsx"]]))
get_gene_names(exome_tables[["ABGP.xlsx"]])
View(search(csv, exome_tables[["ABGP.xlsx"]]))
View(exome_tables[["ABGP.xlsx"]])
View(exome_tables[["Exoma 2166 nuevo.xlsx"]])
View(search(csv, exome_tables[["Exoma 2166 nuevo.xlsx"]]))
View(search(csv, exome_tables[["Paqui.xlsx"]]))
get_gene_names(exome_tables[["Paqui.xlsx"]])
View(search(csv, exome_tables[["Paqui.xlsx"]]))
View(exome_tables[["Paqui.xlsx"]])
28-11
View(exome_tables[["14-173.xlsx"]])
View(exome_tables[["2064.xlsx"]])
View(exome_tables[["ABGP.xlsx"]])
View(exome_tables[["Exoma 2166 nuevo.xlsx"]])
View(search(csv, exome_tables[["Paqui.xlsx"]]))
View(exome_tables[["Paqui.xlsx"]])
dbsnp="rs3217106:rs149871778:rs373924445"
dbsnps = strsplit(dbsnp, ":")
dnsnps
dbsnps
dbsnps[[1]]
dbsnps[[1]][1]
dbsnp="rs124323"
dbsnps = strsplit(dbsnp, ":")
dbsnps[[1]][1]
dbsnps[[1]]
length(dbsnps[[1]])
dbsnp="rs3217106:rs149871778:rs373924445"
dbsnps = strsplit(dbsnp, ":")
length(dbsnps[[1]])
search = function(database, xls){
#found = data.frame(matrix(ncol=ncol(database)))
#colnames(found) = colnames(database)
found = read.table(text="", col.names = colnames(database))
# Si el xlsx tiene entrada para dbsnp e id de refseq
if("dbsnp" %in% colnames(xls) && "transcript" %in% colnames(xls)){
for (i in 1:nrow(xls)){
dbsnpString = toString(xls[i, "dbsnp"])
dbsnps = strsplit(dbsnpString, ":")
refseq_id = toString(xls[i,"transcript"])
for(i in 1:length(dbsnps[[1]])){
dbsnp = dbsnps[[1]][i]
entry = database[database$TRANSCRIPT_REFSEQ_ID == refseq_id & !is.na(database$TRANSCRIPT_REFSEQ_ID) & database$VARIATION_NAME == dbsnp & !is.na(database$VARIATION_NAME), ]
if (!is.na(entry) && nrow(entry) != 0){
found = rbind(found, entry)
break
}
}
}
}
return(found)
}
View(search(csv, exome_tables[["Paqui.xlsx"]]))
View(exome_tables[["14-173.xlsx"]])
View(search(csv, exome_tables[["14-173.xlsx"]]))
View(exome_tables[["2064.xlsx"]])
View(search(csv, exome_tables[["2064.xlsx"]]))
View(exome_tables[["ABGP.xlsx"]])
View(search(csv, exome_tables[["ABGP.xlsx"]]))
View(exome_tables[["Exoma 2166 nuevo.xlsx"]])
View(search(csv, exome_tables[["Exoma 2166 nuevo.xlsx"]]))
View(exome_tables[["Paqui.xlsx"]])
View(search(csv, exome_tables[["Paqui.xlsx"]]))
View(exome_tables[["14-173.xlsx"]])
View(exome_tables[["Paqui.xlsx"]])
View(search(csv, exome_tables[["Exoma 2166 nuevo.xlsx"]]))
View(exome_tables[["Paqui.xlsx"]])
View(exome_tables[["Exoma 2166 nuevo.xlsx"]])
View(exome_tables[["ABGP.xlsx"]])
View(exome_tables[["Exoma 2166 nuevo.xlsx"]])
View(exome_tables[["14-173.xlsx"]])
View(exome_tables[["2064.xlsx"]])
View(search(csv, exome_tables[["Paqui.xlsx"]]))
View(exome_tables[["Paqui.xlsx"]])
View(csv[csv$GENE_NAME=="C6orf7",])
View(csv[csv$GENE_NAME=="AADACL3",])
nrow(csv[csv$GENE_NAME=="AADACL3",])
nrow(csv[csv$GENE_NAME=="C6orf7",])
nrow(csv[csv$GENE_NAME=="GP6",])
nrow(csv[csv$GENE_NAME=="LENG9",])
nrow(csv[csv$GENE_NAME=="NARS2",])
nrow(csv[csv$GENE_NAME=="NUDT11",])
nrow(csv[csv$GENE_NAME=="SAAL1",])
nrow(csv[csv$GENE_NAME=="TOP3B",])
nrow(csv[csv$GENE_NAME=="ZNF682",])
nrow(csv[csv$GENE_NAME=="ZNF827",])
nrow(csv[csv$GENE_NAME=="AADACL3",])
nrow(csv[csv$GENE_NAME=="C6orf7",])
nrow(csv[csv$GENE_NAME=="GP6",])
nrow(csv[csv$GENE_NAME=="LENG9",])
nrow(csv[csv$GENE_NAME=="NARS2",])
nrow(csv[csv$GENE_NAME=="NUDT11",])
nrow(csv[csv$GENE_NAME=="SAAL1",])
nrow(csv[csv$GENE_NAME=="TOP3B",])
nrow(csv[csv$GENE_NAME=="ZNF682",])
View(csv[csv$GENE_NAME=="GP6",])
View(csv[csv$GENE_NAME=="NARS2",])
View(csv[csv$GENE_NAME=="NUDT11",])
View(csv[csv$GENE_NAME=="SAAL1",])
View(csv[csv$GENE_NAME=="TOP3B",])
View(csv[csv$GENE_NAME=="ZNF682",])
View(csv[csv$GENE_NAME=="ZNF827",])
View(exome_tables[["14-173.xlsx"]])
View(exome_tables[["2064.xlsx"]])
View(exome_tables[["ABGP.xlsx"]])
View(exome_tables[["Exoma 2166 nuevo.xlsx"]])
View(exome_tables[["Paqui.xlsx"]])
nrow(exome_tables[["14-173.xlsx"]])
nrow(exome_tables[["2064.xlsx"]])
nrow(exome_tables[["ABGP.xlsx"]])
nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]])
nrow(exome_tables[["Paqui.xlsx"]])
# get genes
genes = c()
for (file in exome_files){
genes = c(genes, as.vector(get_gene_names(exome_tables[[file]])))
}
ados entre todos los pacientes.
length(unique(genes))
length(unique(genes))
mean(c(nrow(exome_tables[["14-173.xlsx"]]),nrow(exome_tables[["2064.xlsx"]]),nrow(exome_tables[["ABGP.xlsx"]]),nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]]),nrow(exome_tables[["Paqui.xlsx"]])))
nrow(exome_tables[["14-173.xlsx"]])
nrow(exome_tables[["2064.xlsx"]])
nrow(exome_tables[["ABGP.xlsx"]])
nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]])
nrow(exome_tables[["Paqui.xlsx"]])
(12+12+13+11+11+13)/5
nrow(exome_tables[["14-173.xlsx"]])
nrow(exome_tables[["2064.xlsx"]])
nrow(exome_tables[["ABGP.xlsx"]])
nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]])
nrow(exome_tables[["Paqui.xlsx"]])
12+13+11+13
12+13+11+11+13
(12+13+11+11+13)/5
(49392+49388+50772+52428+54634)/5
filter_coverage_xls = function(xls){
minCoverage = 20
# Filter the position affected by the mutation
if("proteinPos" %in% colnames(xls)){
xls = xls[xls$proteinPos == 1,]
} else if ("protein" %in% colnames(xls)){
index = with(xls, grepl("p.Met1[a-zA-Z]", protein))
xls = xls[index,]
}
# Filter by coverage and quality
if ("coverage" %in% colnames(xls)){
xls = xls[xls$coverage >= minCoverage,]
}
return(xls)
}
filter_coverage_xls = function(xls){
minCoverage = 20
# Filter by coverage and quality
if ("coverage" %in% colnames(xls)){
xls = xls[xls$coverage >= minCoverage,]
}
return(xls)
}
filter_protein_pos_xls = function(xls){
# Filter the position affected by the mutation
if("proteinPos" %in% colnames(xls)){
xls = xls[xls$proteinPos == 1,]
} else if ("protein" %in% colnames(xls)){
index = with(xls, grepl("p.Met1[a-zA-Z]", protein))
xls = xls[index,]
}
}
search = function(database, xls){
#found = data.frame(matrix(ncol=ncol(database)))
#colnames(found) = colnames(database)
found = read.table(text="", col.names = colnames(database))
# Si el xlsx tiene entrada para dbsnp e id de refseq
if("dbsnp" %in% colnames(xls) && "transcript" %in% colnames(xls)){
for (i in 1:nrow(xls)){
dbsnpString = toString(xls[i, "dbsnp"])
dbsnps = strsplit(dbsnpString, ":")
refseq_id = toString(xls[i,"transcript"])
for(i in 1:length(dbsnps[[1]])){
dbsnp = dbsnps[[1]][i]
entry = database[database$TRANSCRIPT_REFSEQ_ID == refseq_id & !is.na(database$TRANSCRIPT_REFSEQ_ID) & database$VARIATION_NAME == dbsnp & !is.na(database$VARIATION_NAME), ]
if (!is.na(entry) && nrow(entry) != 0){
found = rbind(found, entry)
break
}
}
}
}
return(found)
}
filter_xls = function(xls){
xls = filter_coverage_xls(xls)
xls = filter_protein_pos_xls(xls)
return(xls)
}
filter_coverage_xls = function(xls){
minCoverage = 20
# Filter by coverage and quality
if ("coverage" %in% colnames(xls)){
xls = xls[xls$coverage >= minCoverage,]
}
return(xls)
}
filter_protein_pos_xls = function(xls){
# Filter the position affected by the mutation
if("proteinPos" %in% colnames(xls)){
xls = xls[xls$proteinPos == 1,]
} else if ("protein" %in% colnames(xls)){
index = with(xls, grepl("p.Met1[a-zA-Z]", protein))
xls = xls[index,]
}
}
get_gene_names = function(xls){
if("gene" %in% colnames(xls)){
return(sort(xls$gene))
}
}
get_dbsnp_ids = function(xls){
if("dbsnp" %in% colnames(xls)){
return(sort(xls[!is.na(xls$dbsnp), "dbsnp"]))
}
}
exomes_dir = "~/hemodonacion/data/exomes/"
exome_files = c("14-173.xlsx",
"2064.xlsx",
"ABGP.xlsx",
"Exoma 2166 nuevo.xlsx",
"Paqui.xlsx")
exome_tables = hash()
# Read xlsx files and store it in a hash
for (file in exome_files){
abs_file_dir = paste(exomes_dir, file, sep="")
exome_tables[file] = read.xls(abs_file_dir)
write(paste("exoma", file, "leido."), "")
}
# filter coverage data
for (file in exome_files){
exome_tables[file] = filter_coverage_xls(exome_tables[[file]])
}
# Mutaciones totales por paciente
nrow(exome_tables[["14-173.xlsx"]])
nrow(exome_tables[["2064.xlsx"]])
nrow(exome_tables[["ABGP.xlsx"]])
nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]])
nrow(exome_tables[["Paqui.xlsx"]])
mean(c(nrow(exome_tables[["14-173.xlsx"]]),nrow(exome_tables[["2064.xlsx"]]),nrow(exome_tables[["ABGP.xlsx"]]),nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]]),nrow(exome_tables[["Paqui.xlsx"]])))
for (file in exome_files){
exome_tables[file] = filter_protein_posxls(exome_tables[[file]])
}
for (file in exome_files){
exome_tables[file] = filter_protein_pos_xls(exome_tables[[file]])
}
# Mutaciones en met1 por paciente
nrow(exome_tables[["14-173.xlsx"]])
nrow(exome_tables[["2064.xlsx"]])
filter_protein_pos_xls = function(xls){
# Filter the position affected by the mutation
if("proteinPos" %in% colnames(xls)){
xls = xls[xls$proteinPos == 1,]
} else if ("protein" %in% colnames(xls)){
index = with(xls, grepl("p.Met1[a-zA-Z]", protein))
xls = xls[index,]
}
return(xls)
}
exome_tables = hash()
# Read xlsx files and store it in a hash
for (file in exome_files){
abs_file_dir = paste(exomes_dir, file, sep="")
exome_tables[file] = read.xls(abs_file_dir)
write(paste("exoma", file, "leido."), "")
}
search = function(database, xls){
found = read.table(text="", col.names = colnames(database))
# Si el xlsx tiene entrada para dbsnp e id de refseq
if("dbsnp" %in% colnames(xls) && "transcript" %in% colnames(xls)){
for (i in 1:nrow(xls)){
dbsnpString = toString(xls[i, "dbsnp"])
dbsnps = strsplit(dbsnpString, ":")
refseq_id = toString(xls[i,"transcript"])
for(i in 1:length(dbsnps[[1]])){
dbsnp = dbsnps[[1]][i]
entry = database[database$TRANSCRIPT_REFSEQ_ID == refseq_id &
!is.na(database$TRANSCRIPT_REFSEQ_ID) &
database$VARIATION_NAME == dbsnp &
!is.na(database$VARIATION_NAME), ]
if (!is.na(entry) && nrow(entry) != 0){
found = rbind(found, entry)
break
}
}
}
}
return(found)
}
filter_xls = function(xls){
xls = filter_coverage_xls(xls)
xls = filter_protein_pos_xls(xls)
return(xls)
}
filter_coverage_xls = function(xls){
minCoverage = 20
# Filter by coverage and quality
if ("coverage" %in% colnames(xls)){
xls = xls[xls$coverage >= minCoverage,]
}
return(xls)
}
filter_protein_pos_xls = function(xls){
# Filter the position affected by the mutation
if("proteinPos" %in% colnames(xls)){
xls = xls[xls$proteinPos == 1,]
} else if ("protein" %in% colnames(xls)){
index = with(xls, grepl("p.Met1[a-zA-Z]", protein))
xls = xls[index,]
}
return(xls)
}
get_gene_names = function(xls){
if("gene" %in% colnames(xls)){
return(sort(xls$gene))
}
}
get_dbsnp_ids = function(xls){
if("dbsnp" %in% colnames(xls)){
return(sort(xls[!is.na(xls$dbsnp), "dbsnp"]))
}
}
for (file in exome_files){
exome_tables[file] = filter_coverage_xls(exome_tables[[file]])
}
# Mutaciones totales por paciente
nrow(exome_tables[["14-173.xlsx"]])
nrow(exome_tables[["2064.xlsx"]])
nrow(exome_tables[["ABGP.xlsx"]])
nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]])
nrow(exome_tables[["Paqui.xlsx"]])
mean(c(nrow(exome_tables[["14-173.xlsx"]]),nrow(exome_tables[["2064.xlsx"]]),nrow(exome_tables[["ABGP.xlsx"]]),nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]]),nrow(exome_tables[["Paqui.xlsx"]])))
for (file in exome_files){
exome_tables[file] = filter_protein_pos_xls(exome_tables[[file]])
}
# Mutaciones en met1 por paciente
nrow(exome_tables[["14-173.xlsx"]])
View(exome_tables[["14-173.xlsx"]])
filter_protein_pos_xls = function(xls){
# Filter the position affected by the mutation
if("proteinPos" %in% colnames(xls)){
xls = xls[!is.na(xls$proteinPos) & xls$proteinPos == 1,]
} else if ("protein" %in% colnames(xls)){
index = with(xls, grepl("p.Met1[a-zA-Z]", protein))
xls = xls[index,]
}
return(xls)
}
for (file in exome_files){
exome_tables[file] = filter_protein_pos_xls(exome_tables[[file]])
}
# Mutaciones en met1 por paciente
nrow(exome_tables[["14-173.xlsx"]])
nrow(exome_tables[["2064.xlsx"]])
nrow(exome_tables[["ABGP.xlsx"]])
nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]])
nrow(exome_tables[["Paqui.xlsx"]])
filter_coverage_xls = function(xls){
minCoverage = 20
# Filter by coverage and quality
if ("coverage" %in% colnames(xls)){
xls = xls[!is.na(xls$coverage) & xls$coverage >= minCoverage,]
}
return(xls)
}
exome_tables = hash()
# Read xlsx files and store it in a hash
for (file in exome_files){
abs_file_dir = paste(exomes_dir, file, sep="")
exome_tables[file] = read.xls(abs_file_dir)
write(paste("exoma", file, "leido."), "")
}
# filter coverage
for (file in exome_files){
exome_tables[file] = filter_coverage_xls(exome_tables[[file]])
}
# Mutaciones totales por paciente
nrow(exome_tables[["14-173.xlsx"]])
nrow(exome_tables[["2064.xlsx"]])
nrow(exome_tables[["ABGP.xlsx"]])
nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]])
nrow(exome_tables[["Paqui.xlsx"]])
mean(c(nrow(exome_tables[["14-173.xlsx"]]),nrow(exome_tables[["2064.xlsx"]]),nrow(exome_tables[["ABGP.xlsx"]]),nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]]),nrow(exome_tables[["Paqui.xlsx"]])))
for (file in exome_files){
exome_tables[file] = filter_protein_pos_xls(exome_tables[[file]])
}
# Mutaciones en met1 por paciente
nrow(exome_tables[["14-173.xlsx"]])
nrow(exome_tables[["2064.xlsx"]])
nrow(exome_tables[["ABGP.xlsx"]])
nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]])
nrow(exome_tables[["Paqui.xlsx"]])
mean(c(nrow(exome_tables[["14-173.xlsx"]]),nrow(exome_tables[["2064.xlsx"]]),nrow(exome_tables[["ABGP.xlsx"]]),nrow(exome_tables[["Exoma 2166 nuevo.xlsx"]]),nrow(exome_tables[["Paqui.xlsx"]])))
